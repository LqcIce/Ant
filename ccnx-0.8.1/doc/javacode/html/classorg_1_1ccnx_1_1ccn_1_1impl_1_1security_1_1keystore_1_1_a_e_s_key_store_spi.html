<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Content-Centric Networking in Java: org.ccnx.ccn.impl.security.keystore.AESKeyStoreSpi Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.3 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Packages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><b>org</b>.<b>ccnx</b>.<b>ccn</b>.<a class="el" href="namespaceorg_1_1ccnx_1_1ccn_1_1impl.html">impl</a>.<b>security</b>.<b>keystore</b>.<a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1keystore_1_1_a_e_s_key_store_spi.html">AESKeyStoreSpi</a>
  </div>
</div>
<div class="contents">
<h1>org.ccnx.ccn.impl.security.keystore.AESKeyStoreSpi Class Reference</h1><!-- doxytag: class="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi" --><!-- doxytag: inherits="java::security::KeyStoreSpi" -->
<p>This is a specialized keystore for storing symmetric keys.  
<a href="#_details">More...</a></p>

<p><a href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1keystore_1_1_a_e_s_key_store_spi-members.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9e333343facc4c0c4e7c1feb7e35ce8a"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineAliases" ref="a9e333343facc4c0c4e7c1feb7e35ce8a" args="()" -->
Enumeration&lt; String &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineAliases</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad8fef2925887c40b2a71a405cee8bf97"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineContainsAlias" ref="ad8fef2925887c40b2a71a405cee8bf97" args="(String arg0)" -->
boolean&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineContainsAlias</b> (String arg0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0cd4a1f62ea65fa715e3efe96c019cfd"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineDeleteEntry" ref="a0cd4a1f62ea65fa715e3efe96c019cfd" args="(String arg0)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineDeleteEntry</b> (String arg0)  throws KeyStoreException </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8048fa4cfa0cbdecb311af0143499d44"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineGetCertificate" ref="a8048fa4cfa0cbdecb311af0143499d44" args="(String arg0)" -->
Certificate&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineGetCertificate</b> (String arg0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0ff801d7d938c20650a339ff4b8fa35c"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineGetCertificateAlias" ref="a0ff801d7d938c20650a339ff4b8fa35c" args="(Certificate arg0)" -->
String&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineGetCertificateAlias</b> (Certificate arg0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a586c03759fb17dd5d71c557e41d15a62"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineGetCertificateChain" ref="a586c03759fb17dd5d71c557e41d15a62" args="(String arg0)" -->
Certificate[]&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineGetCertificateChain</b> (String arg0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4414f243cbc76144eb2cd5f8916d3de1"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineGetCreationDate" ref="a4414f243cbc76144eb2cd5f8916d3de1" args="(String arg0)" -->
Date&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineGetCreationDate</b> (String arg0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">KeyStore.Entry&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1keystore_1_1_a_e_s_key_store_spi.html#a5a12736a351b79d754b25425417ad4e2">engineGetEntry</a> (String alias, KeyStore.ProtectionParameter protParam)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a new entry for the keystore if needed.  <a href="#a5a12736a351b79d754b25425417ad4e2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a94ff404705b936d3f9edb2e9d3082d54"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineGetKey" ref="a94ff404705b936d3f9edb2e9d3082d54" args="(String arg0, char[] arg1)" -->
Key&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineGetKey</b> (String arg0, char[] arg1)  throws NoSuchAlgorithmException, UnrecoverableKeyException </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a75751c4c752d70c42fbc6b6567c0be2e"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineIsCertificateEntry" ref="a75751c4c752d70c42fbc6b6567c0be2e" args="(String arg0)" -->
boolean&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineIsCertificateEntry</b> (String arg0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acd056c90a7494ec9e8875a8f2ac01fae"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineIsKeyEntry" ref="acd056c90a7494ec9e8875a8f2ac01fae" args="(String arg0)" -->
boolean&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineIsKeyEntry</b> (String arg0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a945f3fedf312a7bfbcc8c8841b6c93c5"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineLoad" ref="a945f3fedf312a7bfbcc8c8841b6c93c5" args="(InputStream stream, char[] password)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1keystore_1_1_a_e_s_key_store_spi.html#a945f3fedf312a7bfbcc8c8841b6c93c5">engineLoad</a> (InputStream stream, char[] password)  throws IOException, 			NoSuchAlgorithmException, CertificateException </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Load in the key from the keystore file. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a394e4a21e9bcdd7ebc424dd3de91c9f3"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineSetCertificateEntry" ref="a394e4a21e9bcdd7ebc424dd3de91c9f3" args="(String arg0, Certificate arg1)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineSetCertificateEntry</b> (String arg0, Certificate arg1)  throws KeyStoreException </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abfb7c1be0d551dfd1ae278328b8ea29c"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineSetKeyEntry" ref="abfb7c1be0d551dfd1ae278328b8ea29c" args="(String arg0, byte[] arg1, Certificate[] arg2)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineSetKeyEntry</b> (String arg0, byte[] arg1, Certificate[] arg2)  throws KeyStoreException </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7016853cef43ab130df41e099a08006e"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineSetKeyEntry" ref="a7016853cef43ab130df41e099a08006e" args="(String name, Key key, char[] arg2, Certificate[] arg3)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineSetKeyEntry</b> (String name, Key key, char[] arg2, Certificate[] arg3)  throws KeyStoreException </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aef16acb01e49594d6f056a52d87fb95b"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineSize" ref="aef16acb01e49594d6f056a52d87fb95b" args="()" -->
int&nbsp;</td><td class="memItemRight" valign="bottom"><b>engineSize</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5eaee0a2214cee47108c29c6469ae44b"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineStore" ref="a5eaee0a2214cee47108c29c6469ae44b" args="(OutputStream stream, char[] password)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classorg_1_1ccnx_1_1ccn_1_1impl_1_1security_1_1keystore_1_1_a_e_s_key_store_spi.html#a5eaee0a2214cee47108c29c6469ae44b">engineStore</a> (OutputStream stream, char[] password)  throws IOException, 			NoSuchAlgorithmException, CertificateException </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Store the key from _id into a keystore file. <br/></td></tr>
<tr><td colspan="2"><h2>Static Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a543b030326957b1d340569e68a3f8742"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::VERSION" ref="a543b030326957b1d340569e68a3f8742" args="" -->
static final int&nbsp;</td><td class="memItemRight" valign="bottom"><b>VERSION</b> = 1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa807eeb8ab6d9d5c0822f55b72d7a768"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::TYPE" ref="aa807eeb8ab6d9d5c0822f55b72d7a768" args="" -->
static final String&nbsp;</td><td class="memItemRight" valign="bottom"><b>TYPE</b> = &quot;CCN_AES&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac02e672f6f150e29812ce10800ae5544"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::MAC_ALGORITHM" ref="ac02e672f6f150e29812ce10800ae5544" args="" -->
static final String&nbsp;</td><td class="memItemRight" valign="bottom"><b>MAC_ALGORITHM</b> = &quot;HMAC-SHA256&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3acff95f6b6cc90fcaf200088825a4d3"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::AES_ALGORITHM" ref="a3acff95f6b6cc90fcaf200088825a4d3" args="" -->
static final String&nbsp;</td><td class="memItemRight" valign="bottom"><b>AES_ALGORITHM</b> = &quot;AES&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a221700f28a4c92f964aa6a1983d9170e"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::AES_CRYPTO_ALGORITHM" ref="a221700f28a4c92f964aa6a1983d9170e" args="" -->
static final String&nbsp;</td><td class="memItemRight" valign="bottom"><b>AES_CRYPTO_ALGORITHM</b> = &quot;AES/CBC/PKCS5Padding&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aff255becb5892ce6889afae5b270e2c0"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::IV_SIZE" ref="aff255becb5892ce6889afae5b270e2c0" args="" -->
static final int&nbsp;</td><td class="memItemRight" valign="bottom"><b>IV_SIZE</b> = 16</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa0654531c259aaf16711581ff0960ede"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::_random" ref="aa0654531c259aaf16711581ff0960ede" args="" -->
static final Random&nbsp;</td><td class="memItemRight" valign="bottom"><b>_random</b> = new SecureRandom()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaf2795bed6dfa0b3797961302318affb"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::_macKeyMac" ref="aaf2795bed6dfa0b3797961302318affb" args="" -->
static Mac&nbsp;</td><td class="memItemRight" valign="bottom"><b>_macKeyMac</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad0644f3935c903aca045965c563362b8"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::_AESKeyMac" ref="ad0644f3935c903aca045965c563362b8" args="" -->
static Mac&nbsp;</td><td class="memItemRight" valign="bottom"><b>_AESKeyMac</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac066812ac17c132fc25039049c233308"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::_AESKeyAlgorithm" ref="ac066812ac17c132fc25039049c233308" args="" -->
static String&nbsp;</td><td class="memItemRight" valign="bottom"><b>_AESKeyAlgorithm</b> = MAC_ALGORITHM</td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9a5631d8ac9946149c49e8277f87aaa9"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::_id" ref="a9a5631d8ac9946149c49e8277f87aaa9" args="" -->
byte[]&nbsp;</td><td class="memItemRight" valign="bottom"><b>_id</b> = null</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0cdcd0683503e93335b7f4772cffebf1"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::_ourEntry" ref="a0cdcd0683503e93335b7f4772cffebf1" args="" -->
KeyStore.Entry&nbsp;</td><td class="memItemRight" valign="bottom"><b>_ourEntry</b> = null</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad7a0319765da2b14d5bddd52b5f166aa"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::_oid" ref="ad7a0319765da2b14d5bddd52b5f166aa" args="" -->
DERObjectIdentifier&nbsp;</td><td class="memItemRight" valign="bottom"><b>_oid</b> = null</td></tr>
<tr><td colspan="2"><h2>Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20be30b069f09d71e325c67f038430c6"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::_version" ref="a20be30b069f09d71e325c67f038430c6" args="" -->
static DERInteger&nbsp;</td><td class="memItemRight" valign="bottom"><b>_version</b> = new DERInteger(VERSION)</td></tr>
<tr><td colspan="2"><h2>Static Package Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aec53cbcb34de37463ee47a5e84819f4d"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::[static initializer]" ref="aec53cbcb34de37463ee47a5e84819f4d" args="" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>[static initializer]</b></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>This is a specialized keystore for storing symmetric keys. </p>
<p>We looked at PKCS #11 for this but decided against it for now because industry doesn't seem to be standardizing around it - at least not yet, and standard support for it is somewhat sketchy at this point.</p>
<p>The keystore can be used for only one key at a time and is located by naming it with a suffix created from the key's digest.</p>
<p>Following is the formula for the KeyStore</p>
<p>Let P=passphrase Let PT = symmetric key to store Let IV = random 16-bytes</p>
<p>aesK = HMAC-SHA256(P, '') macK = HMAC-SHA256(P, '') AES256-CBC(IV, key, PT) - performs AES256 in CBC mode</p>
<p>SK = IV || AES256-CBC(IV, aesK, PT) || HMAC-SHA256(macK, AES256-CBC(IV, aesK, PT))</p>
<p>SK is the symmetric keystore ciphertext</p>
<p>ASN1 encoded KeyStore = Version || Key algorithm OID || SK </p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a5a12736a351b79d754b25425417ad4e2"></a><!-- doxytag: member="org::ccnx::ccn::impl::security::keystore::AESKeyStoreSpi::engineGetEntry" ref="a5a12736a351b79d754b25425417ad4e2" args="(String alias, KeyStore.ProtectionParameter protParam)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">KeyStore.Entry org.ccnx.ccn.impl.security.keystore.AESKeyStoreSpi.engineGetEntry </td>
          <td>(</td>
          <td class="paramtype">String&nbsp;</td>
          <td class="paramname"> <em>alias</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">KeyStore.ProtectionParameter&nbsp;</td>
          <td class="paramname"> <em>protParam</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a new entry for the keystore if needed. </p>
<p>Since there is only 1 key in the keystore we only ever return the single entry. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/main/org/ccnx/ccn/impl/security/keystore/AESKeyStoreSpi.java</li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated on Wed Oct 9 08:06:05 2013 for Content-Centric Networking in Java by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.3 </small></address>
</body>
</html>
